main.py
from flask import Flask, request, jsonify
import os, requests

app = Flask(__name__)
OPENAI_KEY = os.getenv("OPENAI_API_KEY", None)

@app.route("/")
def home():
    return "GaripMobilAI - live (Flask)!"

@app.route("/ask", methods=["POST"])
def ask():
    data = request.get_json(silent=True) or {}
    question = data.get("question", "")
    if not question:
        return jsonify({"error": "Please send JSON with field 'question'"}), 400

    # Eer OpenAI anahtar覺 varsa modelden cevap al
    if OPENAI_KEY:
        try:
            headers = {
                "Authorization": f"Bearer {OPENAI_KEY}",
                "Content-Type": "application/json"
            }
            payload = {
                "model": "gpt-3.5-turbo",
                "messages": [{"role": "user", "content": question}],
                "max_tokens": 150
            }
            resp = requests.post(
                "https://api.openai.com/v1/chat/completions",
                headers=headers,
                json=payload,
                timeout=15
            )
            if resp.ok:
                j = resp.json()
                answer = j["choices"][0]["message"]["content"].strip()
                return jsonify({"answer": answer, "source": "openai"})
        except Exception:
            pass

    # Basit cevap sistemi (API yoksa)
    q = question.lower()
    if "merhaba" in q or "selam" in q:
        answer = "Merhaba! Ben GaripMobilAI  Nas覺l yard覺mc覺 olabilirim?"
    elif "nas覺ls覺n" in q:
        answer = "襤yiyim, teekk羹rler! Sen nas覺ls覺n?"
    else:
        answer = f"Sorun al覺nd覺: {question}"

    return jsonify({"answer": answer, "source": "fallback"})

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=int(os.environ.get("PORT", 8080)))from fastapi import FastAPI

app = FastAPI()

@app.get("/")
def read_root():
    return {"message": "GaripMobilAI 癟al覺覺yor!"}

